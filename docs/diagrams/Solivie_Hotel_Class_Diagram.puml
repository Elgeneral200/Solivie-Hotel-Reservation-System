@startuml
'==============================================================================
' PROJECT: Solivie Hotel Management System
' DIAGRAM: Complete Class Diagram - System Architecture
' VERSION: 1.0
' DATE: December 19, 2025
'==============================================================================
' DEVELOPMENT TEAM - Solivie Dev
' 1. Muhammed Fathi Kamal
' 2. Mohamed Elsayed Abdelaziz
' 3. Salma Abdelhamid Ahmed
' 4. Dai Ehab Mohamed Reda
' 5. Shaza Mohammed El Said
'==============================================================================

!define CAPTION Solivie Hotel Management System - Enterprise Class Architecture

title CAPTION\n<size:11>Complete System Design - Domain Models, Business Logic, Services & Data Access</size>

'==============================================================================
' PROFESSIONAL ENTERPRISE STYLING
'==============================================================================
skinparam shadowing false
skinparam defaultFontName Arial
skinparam defaultFontSize 9
skinparam classAttributeIconSize 0
skinparam linetype ortho
skinparam nodesep 60
skinparam ranksep 80

skinparam class {
    BackgroundColor #FFFFFF
    BorderColor #2C3E50
    BorderThickness 2
    ArrowColor #34495E
    ArrowThickness 2
    FontSize 9
    FontColor #2C3E50
    FontStyle bold
    AttributeFontColor #34495E
    AttributeFontSize 8
}

skinparam package {
    BackgroundColor #F8F9FA
    BorderColor #34495E
    BorderThickness 2.5
    FontSize 11
    FontStyle bold
    FontColor #1A252F
}

skinparam stereotypeCBackgroundColor #D5F4E6
skinparam stereotypeIBackgroundColor #FFF3CD

skinparam note {
    BackgroundColor #FFF9E6
    BorderColor #8B7355
    BorderThickness 2
    FontSize 9
    FontColor #2C3E50
}

'==============================================================================
' LAYER 1: DOMAIN MODELS (DATABASE ENTITIES)
'==============================================================================
package "Domain Models Layer - Database Entities" #E8F8F5 {
    
    class User {
        - user_id: int <<PK>>
        - email: str <<unique>>
        - password_hash: str
        - first_name: str
        - last_name: str
        - phone_number: str
        - date_of_birth: date
        - nationality: str
        - national_id: str
        - passport_number: str
        - id_expiry_date: date
        - id_verified: bool
        - is_active: bool
        - created_at: datetime
        - updated_at: datetime
        / age: int
        / full_name: str
        / is_id_expired: bool
        __
        + __init__(email: str, password: str, first_name: str, last_name: str, phone: str)
        + verify_password(password: str): bool
        + update_profile(data: dict): bool
        + upload_id_document(id_type: str, id_number: str, expiry: date): bool
        + get_bookings(): List[Booking]
        + get_reviews(): List[Review]
        + calculate_age(): int
        + check_id_expiry(): bool
        + get_account_age_days(): int
        # set_password(password: str): void
        # hash_password(password: str): str
        - validate_email(): bool
        - validate_phone(): bool
    }
    
    class AdminUser {
        - admin_id: int <<PK>>
        - user_id: int <<FK>>
        - role: str
        - permissions: JSON
        - department: str
        - last_login: datetime
        - created_at: datetime
        __
        + __init__(user_id: int, role: str, permissions: dict)
        + has_permission(permission: str): bool
        + grant_permission(permission: str): bool
        + revoke_permission(permission: str): bool
        + get_admin_activities(): List[AuditLog]
        + update_last_login(): void
        + get_managed_bookings(): List[Booking]
        - validate_permissions(): bool
    }
    
    class Room {
        - room_id: int <<PK>>
        - room_number: str <<unique>>
        - room_type: str
        - capacity: int
        - base_price_per_night: float
        - description: str
        - amenities: JSON
        - floor_number: int
        - view_type: str
        - status: str
        - image_url: str
        - is_available: bool
        - size_sqm: float
        - bed_type: str
        - created_at: datetime
        - updated_at: datetime
        / current_price: float
        / average_rating: float
        __
        + __init__(room_number: str, room_type: str, capacity: int, price: float)
        + update_details(data: dict): bool
        + set_status(status: str): bool
        + set_amenities(amenities: List[str]): bool
        + check_availability(check_in: date, check_out: date): bool
        + calculate_price(nights: int, seasonal_rate: float): float
        + get_bookings(): List[Booking]
        + get_reviews(): List[Review]
        + has_amenity(amenity: str): bool
        + get_average_rating(): float
        + upload_image(image_path: str): bool
        - validate_room_number(): bool
        - validate_price(): bool
    }
    
    class Booking {
        - booking_id: int <<PK>>
        - user_id: int <<FK>>
        - room_id: int <<FK>>
        - booking_reference: str <<unique>>
        - check_in_date: date
        - check_out_date: date
        - total_amount: float
        - booking_status: str
        - special_requests: str
        - guest_id_number: str
        - promo_code: str
        - discount_amount: float
        - is_checked_in: bool
        - is_checked_out: bool
        - check_in_time: datetime
        - check_out_time: datetime
        - cancelled_at: datetime
        - cancellation_reason: str
        - created_at: datetime
        - updated_at: datetime
        / nights: int
        / is_active: bool
        / days_until_checkin: int
        / final_amount: float
        __
        + __init__(user_id: int, room_id: int, check_in: date, check_out: date, amount: float)
        + confirm_booking(): bool
        + cancel_booking(reason: str): bool
        + check_in_guest(admin_id: int): bool
        + check_out_guest(admin_id: int): bool
        + calculate_nights(): int
        + calculate_days_until_checkin(): int
        + verify_guest_id(id_number: str): bool
        + add_special_request(request: str): bool
        + apply_promo_code(code: str): bool
        + generate_invoice(): str
        + get_payment(): Payment
        + get_user(): User
        + get_room(): Room
        # update_status(status: str): bool
        - validate_dates(): bool
        - calculate_final_amount(): float
    }
    
    class Payment {
        - payment_id: int <<PK>>
        - booking_id: int <<FK>>
        - transaction_id: str <<unique>>
        - amount: float
        - payment_method: str
        - payment_status: str
        - card_last_four: str
        - cardholder_name: str
        - payment_date: datetime
        - refund_amount: float
        - refund_date: datetime
        - refund_reason: str
        - gateway_response: JSON
        - created_at: datetime
        __
        + __init__(booking_id: int, amount: float, payment_method: str)
        + process_payment(card_data: dict): bool
        + refund_payment(amount: float, reason: str): bool
        + verify_payment(): bool
        + generate_receipt(): str
        + get_booking(): Booking
        + is_refundable(): bool
        + calculate_refund_amount(cancellation_date: date): float
        - validate_card_number(card: str): bool
        - luhn_check(card: str): bool
        - generate_transaction_id(): str
    }
    
    class Review {
        - review_id: int <<PK>>
        - user_id: int <<FK>>
        - room_id: int <<FK>>
        - booking_id: int <<FK>>
        - rating: int
        - comment: str
        - review_date: datetime
        - is_verified: bool
        - admin_response: str
        - response_date: datetime
        - created_at: datetime
        - updated_at: datetime
        __
        + __init__(user_id: int, room_id: int, booking_id: int, rating: int, comment: str)
        + edit_review(rating: int, comment: str): bool
        + delete_review(): bool
        + verify_review(admin_id: int): bool
        + add_admin_response(response: str, admin_id: int): bool
        + get_user(): User
        + get_room(): Room
        + get_booking(): Booking
        - validate_rating(rating: int): bool
        - validate_comment_length(): bool
    }
    
    class Cart {
        - cart_id: int <<PK>>
        - user_id: int <<FK>>
        - created_at: datetime
        - updated_at: datetime
        - expires_at: datetime
        / total_items: int
        / total_price: float
        / is_expired: bool
        __
        + __init__(user_id: int)
        + add_item(room_id: int, check_in: date, check_out: date, price: float): bool
        + remove_item(cart_item_id: int): bool
        + update_item(cart_item_id: int, data: dict): bool
        + clear_cart(): bool
        + calculate_total(): float
        + get_items(): List[CartItem]
        + checkout(): bool
        + is_empty(): bool
        + get_item_count(): int
        + extend_expiry(): void
        - check_expiry(): bool
    }
    
    class CartItem {
        - item_id: int <<PK>>
        - cart_id: int <<FK>>
        - room_id: int <<FK>>
        - check_in_date: date
        - check_out_date: date
        - price_per_night: float
        - created_at: datetime
        / nights: int
        / total_price: float
        __
        + __init__(cart_id: int, room_id: int, check_in: date, check_out: date)
        + calculate_price(): float
        + calculate_nights(): int
        + update_dates(check_in: date, check_out: date): bool
        + get_room(): Room
        + is_available(): bool
        - validate_dates(): bool
    }
    
    class PromoCode {
        - promo_id: int <<PK>>
        - code: str <<unique>>
        - discount_percentage: float
        - discount_amount: float
        - discount_type: str
        - valid_from: date
        - valid_until: date
        - usage_limit: int
        - used_count: int
        - min_booking_amount: float
        - max_discount: float
        - applicable_room_types: JSON
        - is_active: bool
        - created_at: datetime
        / is_valid: bool
        / remaining_uses: int
        __
        + __init__(code: str, discount_type: str, value: float, valid_from: date, valid_until: date)
        + is_valid(): bool
        + can_use(): bool
        + apply_discount(amount: float): float
        + increment_usage(): bool
        + deactivate(): bool
        + get_usage_statistics(): dict
        - check_expiry(): bool
        - validate_discount(): bool
    }
    
    class AuditLog {
        - log_id: int <<PK>>
        - user_id: int <<FK>>
        - admin_id: int <<FK>>
        - action: str
        - entity_type: str
        - entity_id: int
        - changes: JSON
        - ip_address: str
        - user_agent: str
        - timestamp: datetime
        __
        + __init__(user_id: int, action: str, entity_type: str, entity_id: int)
        + log_action(changes: dict, ip: str): bool
        + get_user_activities(user_id: int, limit: int): List[AuditLog]
        + get_admin_activities(admin_id: int, limit: int): List[AuditLog]
        + get_entity_history(entity_type: str, entity_id: int): List[AuditLog]
        + search_logs(criteria: dict): List[AuditLog]
        {static} + create_log(user_id: int, action: str, details: dict): bool
    }
    
    class EmailLog {
        - email_log_id: int <<PK>>
        - recipient_email: str
        - subject: str
        - email_type: str
        - booking_id: int <<FK>>
        - payment_id: int <<FK>>
        - status: str
        - error_message: str
        - sent_at: datetime
        - created_at: datetime
        __
        + __init__(recipient: str, subject: str, email_type: str)
        + mark_as_sent(): bool
        + mark_as_failed(error: str): bool
        + retry_send(): bool
        + get_logs_by_booking(booking_id: int): List[EmailLog]
        {static} + get_failed_emails(): List[EmailLog]
    }
    
    class Session {
        - session_id: int <<PK>>
        - user_id: int <<FK>>
        - session_token: str <<unique>>
        - ip_address: str
        - user_agent: str
        - created_at: datetime
        - expires_at: datetime
        - last_activity: datetime
        - is_active: bool
        / is_expired: bool
        __
        + __init__(user_id: int, token: str, ip: str)
        + is_valid(): bool
        + extend_session(): bool
        + invalidate(): bool
        + update_activity(): void
        {static} + cleanup_expired_sessions(): int
        - check_expiry(): bool
    }
}

'==============================================================================
' LAYER 2: BUSINESS LOGIC LAYER (MANAGERS)
'==============================================================================
package "Business Logic Layer - Domain Service Managers" #EBF5FB {
    
    class AuthenticationManager <<Singleton>> {
        - {static} _instance: AuthenticationManager
        __
        + {static} get_instance(): AuthenticationManager
        + {static} register_user(email: str, password: str, user_data: dict): Tuple[bool, str]
        + {static} login_user(email: str, password: str, ip: str): Tuple[bool, User, str]
        + {static} logout_user(session_token: str): bool
        + {static} verify_credentials(email: str, password: str): bool
        + {static} create_session(user_id: int, ip: str): str
        + {static} validate_session(token: str): Tuple[bool, User]
        + {static} reset_password(email: str): bool
        + {static} change_password(user_id: int, old_pwd: str, new_pwd: str): bool
        + {static} verify_email(token: str): bool
        - {static} validate_password_strength(password: str): Tuple[bool, str]
        - {static} generate_session_token(): str
        - {static} send_verification_email(user: User): bool
    }
    
    class BookingManager <<Service>> {
        __
        + {static} create_booking(user_id: int, room_id: int, check_in: date, check_out: date, amount: float, guest_data: dict): Tuple[bool, int, str]
        + {static} get_user_bookings(user_id: int, status: str): List[Booking]
        + {static} get_booking_by_id(booking_id: int): Booking
        + {static} get_booking_by_reference(reference: str): Booking
        + {static} cancel_booking(booking_id: int, reason: str, user_id: int): Tuple[bool, str]
        + {static} update_booking(booking_id: int, data: dict): bool
        + {static} get_all_bookings(filters: dict): List[Booking]
        + {static} search_bookings(query: str, criteria: dict): List[Booking]
        + {static} get_bookings_by_date_range(start: date, end: date): List[Booking]
        + {static} get_active_bookings(): List[Booking]
        + {static} get_upcoming_bookings(days: int): List[Booking]
        + {static} apply_promo_code(booking_id: int, promo_code: str): Tuple[bool, float]
        - {static} validate_booking_dates(check_in: date, check_out: date): Tuple[bool, str]
        - {static} generate_booking_reference(): str
        - {static} check_room_availability(room_id: int, check_in: date, check_out: date): bool
    }
    
    class RoomManager <<Service>> {
        __
        + {static} get_all_rooms(): List[Room]
        + {static} get_available_rooms(check_in: date, check_out: date, capacity: int): List[Room]
        + {static} get_room_by_id(room_id: int): Room
        + {static} get_room_by_number(room_number: str): Room
        + {static} add_room(room_data: dict): Tuple[bool, str]
        + {static} update_room(room_id: int, room_data: dict): bool
        + {static} delete_room(room_id: int): bool
        + {static} search_rooms(filters: dict): List[Room]
        + {static} filter_by_amenities(rooms: List[Room], amenities: List[str]): List[Room]
        + {static} filter_by_price(rooms: List[Room], min_price: float, max_price: float): List[Room]
        + {static} filter_by_type(rooms: List[Room], room_type: str): List[Room]
        + {static} filter_by_view(rooms: List[Room], view_type: str): List[Room]
        + {static} update_room_status(room_id: int, status: str): bool
        + {static} get_rooms_by_floor(floor: int): List[Room]
        + {static} get_room_statistics(): dict
        - {static} validate_room_data(data: dict): Tuple[bool, str]
    }
    
    class CheckInManager <<Service>> {
        __
        + {static} check_in_guest(booking_id: int, admin_id: int, id_verified: bool): Tuple[bool, str]
        + {static} check_out_guest(booking_id: int, admin_id: int): Tuple[bool, str]
        + {static} get_todays_arrivals(): List[Booking]
        + {static} get_todays_departures(): List[Booking]
        + {static} get_arrivals_by_date(date: date): List[Booking]
        + {static} get_departures_by_date(date: date): List[Booking]
        + {static} verify_guest_identity(booking_id: int, id_number: str): Tuple[bool, str]
        + {static} get_current_occupancy(): int
        + {static} get_checked_in_guests(): List[Booking]
        + {static} get_overdue_checkouts(): List[Booking]
        - {static} update_room_status(room_id: int, status: str): bool
        - {static} log_checkin_activity(booking_id: int, admin_id: int): bool
    }
    
    class CartManager <<Service>> {
        __
        + {static} add_to_cart(user_id: int, room_id: int, check_in: date, check_out: date): Tuple[bool, str]
        + {static} remove_from_cart(user_id: int, cart_item_id: int): bool
        + {static} update_cart_item(cart_item_id: int, data: dict): bool
        + {static} get_cart_items(user_id: int): List[dict]
        + {static} get_or_create_cart(user_id: int): Cart
        + {static} clear_cart(user_id: int): bool
        + {static} calculate_cart_total(user_id: int): float
        + {static} validate_cart_checkout(user_id: int): Tuple[bool, str]
        + {static} cleanup_expired_carts(): int
        - {static} validate_cart_item(room_id: int, check_in: date, check_out: date): Tuple[bool, str]
    }
    
    class UserManager <<Service>> {
        __
        + {static} get_user_by_id(user_id: int): User
        + {static} get_user_by_email(email: str): User
        + {static} get_all_users(include_inactive: bool): List[User]
        + {static} update_user_profile(user_id: int, data: dict): Tuple[bool, str]
        + {static} upload_id_document(user_id: int, id_type: str, id_number: str, expiry: date): Tuple[bool, str]
        + {static} verify_user_id(user_id: int, admin_id: int): bool
        + {static} search_users(query: str): List[User]
        + {static} deactivate_user(user_id: int, admin_id: int): bool
        + {static} activate_user(user_id: int, admin_id: int): bool
        + {static} get_user_statistics(user_id: int): dict
        + {static} check_id_expiry_alerts(): List[User]
        - {static} validate_user_data(data: dict): Tuple[bool, str]
        - {static} log_user_update(user_id: int, admin_id: int, changes: dict): bool
    }
    
    class AdminManager <<Service>> {
        __
        + {static} get_dashboard_stats(): dict
        + {static} get_revenue_data(start_date: date, end_date: date): dict
        + {static} get_occupancy_rate(month: int, year: int): float
        + {static} get_booking_statistics(period: str): dict
        + {static} get_user_statistics(): dict
        + {static} get_room_statistics(): dict
        + {static} generate_report(report_type: str, params: dict): dict
        + {static} export_report(data: dict, format: str): str
        + {static} get_recent_activities(limit: int): List[AuditLog]
        + {static} get_revenue_by_room_type(): dict
        + {static} get_popular_rooms(limit: int): List[Room]
        - {static} calculate_metrics(bookings: List[Booking]): dict
        - {static} format_report_data(data: dict, report_type: str): dict
    }
    
    class ReviewManager <<Service>> {
        __
        + {static} create_review(user_id: int, room_id: int, booking_id: int, rating: int, comment: str): Tuple[bool, str]
        + {static} get_room_reviews(room_id: int, verified_only: bool): List[Review]
        + {static} get_user_reviews(user_id: int): List[Review]
        + {static} update_review(review_id: int, rating: int, comment: str): bool
        + {static} delete_review(review_id: int, user_id: int): bool
        + {static} verify_review(review_id: int, admin_id: int): bool
        + {static} add_admin_response(review_id: int, response: str, admin_id: int): bool
        + {static} get_average_rating(room_id: int): float
        + {static} can_user_review(user_id: int, booking_id: int): bool
        - {static} validate_review_data(rating: int, comment: str): Tuple[bool, str]
    }
}

'==============================================================================
' LAYER 3: APPLICATION SERVICE LAYER
'==============================================================================
package "Application Service Layer - Business Services" #FEF9E7 {
    
    class PaymentProcessor <<Service>> {
        __
        + {static} process_payment(booking_id: int, amount: float, payment_method: str, card_data: dict): Tuple[bool, str]
        + {static} refund_payment(payment_id: int, amount: float, reason: str): Tuple[bool, str]
        + {static} verify_payment(transaction_id: str): bool
        + {static} get_payment_by_booking(booking_id: int): Payment
        + {static} get_payment_by_transaction(transaction_id: str): Payment
        + {static} calculate_refund_amount(booking: Booking): float
        + {static} process_partial_refund(payment_id: int, amount: float): bool
        - {static} validate_card(card_number: str, cvv: str, expiry: str, name: str): Tuple[bool, str]
        - {static} luhn_algorithm(card_number: str): bool
        - {static} connect_to_gateway(): bool
        - {static} generate_transaction_id(): str
    }
    
    class EmailService <<Service>> {
        - smtp_server: str
        - smtp_port: int
        - sender_email: str
        - sender_password: str
        - use_tls: bool
        - testing_mode: bool
        __
        + __init__(config: dict)
        + send_booking_confirmation(user_email: str, booking: Booking, user: User, room: Room): bool
        + send_payment_receipt(user_email: str, payment: Payment, booking: Booking): bool
        + send_cancellation_email(user_email: str, booking: Booking, refund_amount: float): bool
        + send_check_in_reminder(user_email: str, booking: Booking, days_before: int): bool
        + send_password_reset_email(user_email: str, reset_token: str): bool
        + send_verification_email(user_email: str, verification_token: str): bool
        + send_admin_notification(admin_email: str, subject: str, message: str): bool
        - connect_smtp(): SMTPConnection
        - create_html_template(template_name: str, data: dict): str
        - load_template(template_path: str): str
        - log_email(recipient: str, subject: str, status: str, email_type: str): bool
        - handle_email_error(error: Exception, recipient: str): void
    }
    
    class InvoiceGenerator <<Service>> {
        __
        + {static} generate_invoice(booking_id: int): str
        + {static} generate_receipt(payment_id: int): str
        + {static} generate_final_invoice(booking_id: int): str
        + {static} create_pdf(data: dict, template: str): bytes
        + {static} save_invoice(booking_id: int, pdf_data: bytes): str
        + {static} get_invoice_path(booking_id: int): str
        + {static} email_invoice(booking_id: int, recipient: str): bool
        - {static} format_invoice_data(booking: Booking, payment: Payment): dict
        - {static} format_receipt_data(payment: Payment): dict
        - {static} get_template(template_type: str): str
        - {static} calculate_totals(booking: Booking): dict
    }
    
    class AvailabilityChecker <<Service>> {
        __
        + {static} check_room_availability(room_id: int, check_in: date, check_out: date): bool
        + {static} get_available_dates(room_id: int, month: int, year: int): List[str]
        + {static} find_available_rooms(check_in: date, check_out: date, capacity: int, filters: dict): List[Room]
        + {static} get_conflicting_bookings(room_id: int, check_in: date, check_out: date): List[Booking]
        + {static} check_multiple_rooms(room_ids: List[int], check_in: date, check_out: date): dict
        - {static} check_date_conflicts(room_id: int, check_in: date, check_out: date): int
        - {static} is_room_available_on_date(room_id: int, check_date: date): bool
    }
    
    class AvailabilityCalendar <<Service>> {
        __
        + {static} get_monthly_availability(room_id: int, month: int, year: int): dict
        + {static} get_all_rooms_availability(month: int, year: int): dict
        + {static} get_availability_by_room_type(room_type: str, month: int, year: int): dict
        + {static} get_booking_calendar(start_date: date, end_date: date): dict
        + {static} get_occupancy_calendar(month: int, year: int): List[dict]
        - {static} generate_calendar_grid(month: int, year: int): List[date]
        - {static} mark_booked_dates(room_id: int, calendar: dict): dict
    }
    
    class PricingCalculator <<Service>> {
        __
        + {static} calculate_room_price(room_id: int, check_in: date, check_out: date): float
        + {static} calculate_total_price(room_id: int, nights: int, promo_code: str): float
        + {static} apply_promo_code(amount: float, promo_code: str): Tuple[float, float]
        + {static} calculate_nights(check_in: date, check_out: date): int
        + {static} get_seasonal_multiplier(date: date): float
        + {static} calculate_cart_total(cart_items: List[CartItem], promo_code: str): dict
        + {static} calculate_refund_amount(booking: Booking, cancellation_date: date): float
        + {static} apply_taxes(amount: float): float
        - {static} validate_promo_code(code: str): Tuple[bool, PromoCode]
        - {static} get_base_price(room_id: int): float
    }
    
    class Validators <<Utility>> {
        __
        + {static} validate_email(email: str): bool
        + {static} validate_password(password: str): Tuple[bool, str]
        + {static} validate_phone_number(phone: str): bool
        + {static} validate_national_id(id_number: str, nationality: str): bool
        + {static} validate_passport(passport: str): bool
        + {static} validate_date_range(start: date, end: date): Tuple[bool, str]
        + {static} validate_card_number(card: str): bool
        + {static} validate_cvv(cvv: str): bool
        + {static} validate_expiry_date(expiry: str): bool
        + {static} validate_age(birth_date: date, min_age: int): bool
        + {static} sanitize_input(text: str): str
        - {static} check_email_format(email: str): bool
        - {static} check_password_strength(password: str): dict
    }
    
    class Helpers <<Utility>> {
        __
        + {static} format_currency(amount: float, currency: str): str
        + {static} format_datetime(dt: datetime, format: str): str
        + {static} format_date(d: date, format: str): str
        + {static} generate_booking_reference(): str
        + {static} generate_transaction_id(): str
        + {static} generate_random_token(length: int): str
        + {static} calculate_age(birth_date: date): int
        + {static} calculate_days_between(start: date, end: date): int
        + {static} get_current_timestamp(): datetime
        + {static} parse_date(date_str: str, format: str): date
        + {static} truncate_text(text: str, length: int): str
    }
    
    class SolivieUI <<Presentation>> {
        __
        + {static} inject_custom_css(): void
        + {static} page_header(title: str, subtitle: str, icon: str): void
        + {static} success_message(message: str, icon: str): void
        + {static} error_message(message: str, icon: str): void
        + {static} info_message(message: str, icon: str): void
        + {static} warning_message(message: str, icon: str): void
        + {static} footer(): void
        + {static} display_room_card(room: Room): void
        + {static} display_booking_card(booking: Booking): void
        + {static} display_metric_card(title: str, value: str, icon: str): void
        - {static} load_css(): str
        - {static} get_color_scheme(): dict
    }
    
    class Config <<Configuration>> {
        + APP_NAME: str
        + APP_VERSION: str
        + DATABASE_URL: str
        + SECRET_KEY: str
        + SMTP_SERVER: str
        + SMTP_PORT: int
        + SENDER_EMAIL: str
        + SENDER_PASSWORD: str
        + MIN_BOOKING_DAYS: int
        + MAX_BOOKING_DAYS: int
        + CANCELLATION_POLICY_DAYS: int
        + FULL_REFUND_DAYS: int
        + PARTIAL_REFUND_PERCENTAGE: float
        + TAX_RATE: float
        + CURRENCY: str
        + ROOM_TYPES: List[str]
        + ROOM_STATUSES: List[str]
        + BOOKING_STATUSES: List[str]
        + PAYMENT_METHODS: List[str]
        __
        + {static} load_config(): dict
        + {static} get_value(key: str): any
        + {static} update_value(key: str, value: any): bool
        - {static} validate_config(): bool
    }
    
    class Constants <<Configuration>> {
        + ROOM_TYPE_STANDARD: str
        + ROOM_TYPE_DELUXE: str
        + ROOM_TYPE_SUITE: str
        + STATUS_AVAILABLE: str
        + STATUS_OCCUPIED: str
        + STATUS_MAINTENANCE: str
        + BOOKING_CONFIRMED: str
        + BOOKING_CHECKED_IN: str
        + BOOKING_CHECKED_OUT: str
        + BOOKING_CANCELLED: str
        + PAYMENT_PENDING: str
        + PAYMENT_COMPLETED: str
        + PAYMENT_REFUNDED: str
        + AMENITY_WIFI: str
        + AMENITY_TV: str
        + AMENITY_AC: str
        __
        + {static} get_all_room_types(): List[str]
        + {static} get_all_statuses(): dict
    }
}

'==============================================================================
' LAYER 4: DATA ACCESS LAYER
'==============================================================================
package "Data Access Layer - Persistence Management" #FADBD8 {
    
    class DatabaseManager <<Singleton>> {
        - {static} _instance: DatabaseManager
        - engine: Engine
        - session_factory: sessionmaker
        - connection_pool: Pool
        __
        + {static} get_instance(): DatabaseManager
        + {static} get_session(): Session
        + {static} close_session(session: Session): void
        + {static} initialize_database(): bool
        + {static} seed_data(): bool
        + {static} backup_database(backup_path: str): bool
        + {static} restore_database(backup_path: str): bool
        + {static} get_stats(): dict
        + {static} execute_query(query: str, params: dict): any
        + {static} migrate_schema(version: int): bool
        - __init__()
        - create_tables(): bool
        - create_indexes(): bool
        - check_connection(): bool
    }
}

'==============================================================================
' LAYER 5: EXTERNAL INTEGRATION INTERFACES
'==============================================================================
package "External Integration Interfaces" #D6EAF8 {
    
    interface PaymentGateway <<interface>> {
        + process_transaction(amount: float, card_data: dict): Tuple[bool, str, str]
        + verify_transaction(transaction_id: str): Tuple[bool, dict]
        + refund_transaction(transaction_id: str, amount: float): Tuple[bool, str]
        + get_transaction_status(transaction_id: str): str
    }
    
    interface PDFGenerator <<interface>> {
        + create_pdf(template: str, data: dict): bytes
        + save_pdf(file_path: str, pdf_data: bytes): bool
        + add_header(pdf: bytes, header: str): bytes
        + add_footer(pdf: bytes, footer: str): bytes
    }
    
    interface SMTPConnection <<interface>> {
        + connect(host: str, port: int, use_tls: bool): bool
        + authenticate(username: str, password: str): bool
        + send_email(to: str, subject: str, body: str, attachments: List): bool
        + disconnect(): bool
    }
}

'==============================================================================
' ENTITY RELATIONSHIPS - COMPOSITION (STRONG OWNERSHIP)
'==============================================================================
User "1" *-- "0..*" Booking : owns >
User "1" *-- "0..1" Cart : owns >
User "1" *-- "0..*" Review : writes >
Cart "1" *-- "0..*" CartItem : contains >
Booking "1" *-- "1" Payment : has >

'==============================================================================
' ENTITY RELATIONSHIPS - AGGREGATION (WEAK OWNERSHIP)
'==============================================================================
Room "1" o-- "0..*" Booking : reserved_in >
Room "1" o-- "0..*" Review : reviewed_in >
Room "1" o-- "0..*" CartItem : added_to >

'==============================================================================
' ENTITY RELATIONSHIPS - ASSOCIATION
'==============================================================================
Booking "0..*" -- "1" Room : reserves >
Booking "0..*" -- "1" User : made_by >
Review "0..*" -- "1" Room : rates >
Review "0..*" -- "1" User : written_by >
Review "0..1" -- "0..1" Booking : based_on >
Payment "1" -- "1" Booking : pays_for >
CartItem "0..*" -- "1" Room : selects >
Cart "1" -- "1" User : belongs_to >
Session "0..*" -- "1" User : authenticated_as >
AuditLog "0..*" -- "0..1" User : tracks >
AuditLog "0..*" -- "0..1" AdminUser : performed_by >
EmailLog "0..*" -- "0..1" Booking : related_to >
EmailLog "0..*" -- "0..1" Payment : confirms >
PromoCode "0..1" -- "0..*" Booking : applied_to >

'==============================================================================
' INHERITANCE RELATIONSHIPS
'==============================================================================
AdminUser --|> User : extends

'==============================================================================
' BUSINESS LOGIC DEPENDENCIES
'==============================================================================
AuthenticationManager ..> User : <<creates>>
AuthenticationManager ..> Session : <<creates>>
AuthenticationManager ..> DatabaseManager : <<uses>>
AuthenticationManager ..> Validators : <<uses>>
AuthenticationManager ..> EmailService : <<uses>>

BookingManager ..> Booking : <<manages>>
BookingManager ..> Room : <<uses>>
BookingManager ..> User : <<uses>>
BookingManager ..> DatabaseManager : <<uses>>
BookingManager ..> EmailService : <<uses>>
BookingManager ..> PricingCalculator : <<uses>>
BookingManager ..> AvailabilityChecker : <<uses>>
BookingManager ..> AuditLog : <<creates>>

RoomManager ..> Room : <<manages>>
RoomManager ..> DatabaseManager : <<uses>>
RoomManager ..> Validators : <<uses>>
RoomManager ..> AuditLog : <<creates>>

CheckInManager ..> Booking : <<manages>>
CheckInManager ..> RoomManager : <<uses>>
CheckInManager ..> AuditLog : <<creates>>

CartManager ..> Cart : <<manages>>
CartManager ..> CartItem : <<manages>>
CartManager ..> PricingCalculator : <<uses>>
CartManager ..> AvailabilityChecker : <<uses>>

UserManager ..> User : <<manages>>
UserManager ..> DatabaseManager : <<uses>>
UserManager ..> Validators : <<uses>>
UserManager ..> AuditLog : <<creates>>

AdminManager ..> DatabaseManager : <<uses>>
AdminManager ..> BookingManager : <<uses>>
AdminManager ..> RoomManager : <<uses>>
AdminManager ..> UserManager : <<uses>>

ReviewManager ..> Review : <<manages>>
ReviewManager ..> Booking : <<validates>>
ReviewManager ..> DatabaseManager : <<uses>>

'==============================================================================
' SERVICE LAYER DEPENDENCIES
'==============================================================================
PaymentProcessor ..> Payment : <<creates>>
PaymentProcessor ..> PaymentGateway : <<uses>>
PaymentProcessor ..> EmailService : <<uses>>
PaymentProcessor ..> Validators : <<uses>>
PaymentProcessor ..> AuditLog : <<creates>>

EmailService ..> SMTPConnection : <<uses>>
EmailService ..> EmailLog : <<creates>>
EmailService ..> Config : <<reads>>

InvoiceGenerator ..> PDFGenerator : <<uses>>
InvoiceGenerator ..> Booking : <<uses>>
InvoiceGenerator ..> Payment : <<uses>>
InvoiceGenerator ..> Helpers : <<uses>>

AvailabilityChecker ..> Room : <<checks>>
AvailabilityChecker ..> Booking : <<checks>>
AvailabilityChecker ..> DatabaseManager : <<uses>>

AvailabilityCalendar ..> AvailabilityChecker : <<uses>>
AvailabilityCalendar ..> Booking : <<queries>>
AvailabilityCalendar ..> Room : <<queries>>

PricingCalculator ..> Room : <<calculates>>
PricingCalculator ..> PromoCode : <<applies>>
PricingCalculator ..> Config : <<reads>>

SolivieUI ..> Helpers : <<uses>>
SolivieUI ..> Config : <<reads>>

'==============================================================================
' DOCUMENTATION NOTES
'==============================================================================
note as ArchitectureOverview
  **System Architecture Overview**
  ════════════════════════════════════════════════════
  **Layered Architecture Pattern:**
  
  **Layer 1: Domain Models (Entities)**
  • Core business entities with database persistence
  • Encapsulate business rules and data validation
  • ORM-mapped classes with relationships
  
  **Layer 2: Business Logic (Managers)**
  • Domain service managers for business operations
  • Coordinate entity interactions
  • Enforce business rules and workflows
  
  **Layer 3: Application Services**
  • Cross-cutting concerns and utilities
  • External system integrations
  • Helper functions and configurations
  
  **Layer 4: Data Access**
  • Database connection and session management
  • Query execution and transaction control
  
  **Layer 5: External Interfaces**
  • Third-party service contracts
  • Integration points with external systems
  
  **Design Patterns Used:**
  • Singleton Pattern (Managers, Database)
  • Service Layer Pattern
  • Repository Pattern (implicit in Managers)
  • Facade Pattern (UI Layer)
end note

note as RelationshipLegend
  **UML Relationship Legend**
  ════════════════════════════════════════════════════
  **Visibility Modifiers:**
  **+** Public - accessible from anywhere
  **-** Private - accessible only within class
  **#** Protected - accessible in class and subclasses
  **~** Package - accessible within same package
  **/** Derived - calculated/computed values
  
  **Relationship Types:**
  **───────>** Association (knows-a relationship)
  **. . . . . >** Dependency (uses temporarily)
  **────|>** Generalization (is-a / inheritance)
  **◇─────>** Aggregation (has-a, independent lifecycle)
  **◆─────>** Composition (owns, dependent lifecycle)
  
  **Stereotypes:**
  **<<PK>>** Primary Key constraint
  **<<FK>>** Foreign Key constraint
  **<<unique>>** Unique constraint
  **<<interface>>** Interface definition
  **<<Singleton>>** Singleton pattern implementation
  **<<Service>>** Service layer component
  **<<Utility>>** Utility class with static methods
  **<<Configuration>>** Configuration/Constants class
  
  **Multiplicity:**
  **1** - Exactly one
  **0..1** - Zero or one
  **0..***, ***  - Zero or more
  **1..*  - One or more
end note

note as DesignPrinciples
  **SOLID Design Principles Applied**
  ════════════════════════════════════════════════════
  **S - Single Responsibility Principle**
  Each class has one clear responsibility
  (e.g., BookingManager handles only booking operations)
  
  **O - Open/Closed Principle**
  Classes open for extension via inheritance
  Closed for modification via encapsulation
  
  **L - Liskov Substitution Principle**
  AdminUser can substitute User where needed
  Interface implementations are interchangeable
  
  **I - Interface Segregation Principle**
  Focused interfaces for external integrations
  No client forced to depend on unused methods
  
  **D - Dependency Inversion Principle**
  High-level modules depend on abstractions
  External systems accessed via interfaces
  
  **Additional Patterns:**
  • Separation of Concerns (layered architecture)
  • Don't Repeat Yourself (utility classes)
  • Keep It Simple (clear class responsibilities)
end note

note bottom of DatabaseManager
  **Singleton Pattern Implementation**
  ────────────────────────────────────
  • Single database connection instance
  • Thread-safe session management
  • Connection pooling for performance
  • Automatic schema migration support
end note

note bottom of PaymentGateway
  **External Payment Integration**
  ────────────────────────────────────
  • Secure transaction processing
  • PCI-DSS compliance required
  • Supports multiple payment methods
  • Real-time verification and refunds
end note

note bottom of EmailService
  **Email Notification System**
  ────────────────────────────────────
  • SMTP-based email delivery
  • HTML template support
  • Automatic retry mechanism
  • Comprehensive logging
  • Supports transactional emails
end note

legend right
  |= **Symbol** |= **Meaning** |
  | ◆───> | Composition (owns, strong) |
  | ◇───> | Aggregation (has, weak) |
  | ──────> | Association (uses) |
  | . . . . . > | Dependency (temporary) |
  | ────|> | Inheritance (extends) |
  
  **Diagram Statistics:**
  • Total Classes: 33
  • Domain Entities: 13
  • Manager Services: 8
  • Application Services: 12
  • External Interfaces: 3
  
  **Coverage:** Complete system architecture
  **Last Updated:** December 19, 2025
  **Solivie Dev Team**
endlegend

footer Solivie Hotel Management System | Development Team: Muhammed Fathi Kamal, Mohamed Elsayed Abdelaziz, Salma Abdelhamid Ahmed, Dai Ehab Mohamed Reda, Shaza Mohammed El Said | © 2025

@enduml
