@startuml Revenue Report Sequence

skinparam {
  backgroundColor #FFFFFF
  defaultFontName Segoe UI
  defaultFontSize 10
  shadowing true
  shadowingIntensity 15
  
  ParticipantBackgroundColor #FFFFFF
  ParticipantBorderColor #2C3E50
  ParticipantBorderThickness 2
  ParticipantFontColor #2C3E50
  ParticipantFontSize 11
  ParticipantFontStyle bold
  
  ActorBackgroundColor #E3F2FD
  ActorBorderColor #1976D2
  ActorFontColor #2C3E50
  ActorFontSize 11
  ActorFontStyle bold
  
  DatabaseBackgroundColor #F3E5F5
  DatabaseBorderColor #7B1FA2
  DatabaseFontColor #2C3E50
  DatabaseFontSize 11
  DatabaseFontStyle bold
  
  ArrowColor #2C3E50
  ArrowThickness 1.5
  ArrowFontColor #2C3E50
  ArrowFontSize 9
  
  NoteBackgroundColor #FFF3E0
  NoteBorderColor #FF9800
  NoteFontColor #5D4037
  NoteFontSize 9
  NoteRoundCorner 8
  
  LifeLineBackgroundColor #F5F5F5
  LifeLineBorderColor #BDBDBD
  
  AltBackgroundColor #E8F5E9
  AltBorderColor #388E3C
  AltFontColor #2C3E50
  
  LoopBackgroundColor #FFF3E0
  LoopBorderColor #FF9800
  LoopFontColor #5D4037
}

title <color:#2C3E50><size:16><b>SOLIVIE HOTEL - REVENUE ANALYTICS SEQUENCE DIAGRAM</b></size></title>

caption <color:#546E7A><i>Financial reporting and revenue analysis workflow</i></caption>

actor "Hotel Manager" as Admin <<Management>>
participant "Analytics Dashboard" as RP <<UI>>
participant "Report Engine" as RG <<Service>>
participant "Data Aggregator" as DA <<Service>>
participant "Visualization Service" as VS <<Service>>
participant "Export Service" as ES <<Service>>
database "Hotel Database" as DB <<PostgreSQL>>

' ============================================
' PHASE 1: REPORT CONFIGURATION
' ============================================

Admin -> RP: **1. NAVIGATE to analytics**\nğŸ“Š Access reports section
note right of Admin
  <color:#2C3E50><b>User Role</b></color>
  â€¢ Management access required
  â€¢ Financial permissions
  â€¢ Audit trail logging
  â€¢ Data export rights
end note

activate RP

RP -> RP: **2. LOAD report_templates**\nğŸ“‹ Available report types
note right of RP
  <color:#2C3E50><b>Report Options</b></color>
  â€¢ Revenue Analysis
  â€¢ Occupancy Reports
  â€¢ Guest Demographics
  â€¢ Operational Metrics
  â€¢ Custom Reports
end note

Admin -> RP: **3. SELECT "Revenue Report"**\nğŸ’° Financial analytics
Admin -> RP: **4. SET date_range**\nğŸ“… Custom time period

note right of RP
  <color:#2C3E50><b>Date Parameters</b></color>
  â€¢ Start date: [YYYY-MM-DD]
  â€¢ End date: [YYYY-MM-DD]
  â€¢ Comparison periods
  â€¢ Real-time vs historical
end note

Admin -> RP: **5. APPLY filters**\nğŸ” Data segmentation
note right of RP
  <color:#2C3E50><b>Filter Options</b></color>
  â€¢ Property/location
  â€¢ Room categories
  â€¢ Guest segments
  â€¢ Booking channels
  â€¢ Payment methods
end note

Admin -> RP: **6. INITIATE generation**\nğŸš€ Generate report
RP -> RG: **7. generate_revenue_report()**\nğŸ“ˆ Start processing
activate RG

' ============================================
' PHASE 2: DATA EXTRACTION
' ============================================

RG -> DA: **8. extract_financial_data()**\nğŸ’° Payment information
activate DA

DA -> DB: **9. QUERY payments**\nğŸ“Š Completed transactions
activate DB
DB --> DA: **10. RETURN payment_records**\nâœ… [N] transactions found
deactivate DB

DA -> DB: **11. QUERY bookings**\nğŸ“… Reservation data
activate DB
DB --> DA: **12. RETURN booking_records**\nâœ… [M] bookings retrieved
deactivate DB

DA -> DB: **13. QUERY refunds**\nğŸ’¸ Reversed transactions
activate DB
DB --> DA: **14. RETURN refund_records**\nâœ… [R] refunds processed
deactivate DB

DA --> RG: **15. RETURN consolidated_data**\nğŸ“¦ Raw data aggregated
deactivate DA

' ============================================
' PHASE 3: DATA PROCESSING
' ============================================

RG -> RG: **16. calculate_revenue_metrics()**\nğŸ§® Financial calculations

RG -> RG: **17. compute_total_revenue()**\nğŸ’° Gross revenue
note right of RG
  <color:#2C3E50><b>Revenue Calculation</b></color>
  Gross Revenue = Sum(all payments)
  - Refunds
  - Cancellations
  + Service charges
  = Net Revenue
end note

RG -> RG: **18. compute_average_transaction()**\nğŸ“Š Statistical analysis

RG -> RG: **19. analyze_payment_methods()**\nğŸ’³ Method breakdown
loop **Each payment method**
  RG -> RG: **20. sum_by_method()**\nğŸ’µ Method total
  RG -> RG: **21. calculate_percentage()**\nğŸ“ˆ Market share
end loop

RG -> RG: **22. compute_daily_trends()**\nğŸ“… Time-based analysis

RG -> RG: **23. calculate_occupancy_revenue()**\nğŸ¨ Room revenue correlation

RG -> RG: **24. identify_top_segments()**\nğŸ‘¥ High-value segments

' ============================================
' PHASE 4: ADVANCED ANALYTICS
' ============================================

RG -> RG: **25. generate_comparative_analysis()**\nğŸ“Š Period comparison
note right of RG
  <color:#2C3E50><b>Comparative Metrics</b></color>
  â€¢ Month-over-month growth
  â€¢ Year-over-year performance
  â€¢ Seasonal patterns
  â€¢ Trend projections
  â€¢ Forecast accuracy
end note

RG -> RG: **26. compute_kpis()**\nğŸ¯ Performance indicators
loop **Each KPI category**
  RG -> RG: **27. calculate_kpi()**\nğŸ“ˆ Performance metric
  RG -> RG: **28. assess_targets()**\nğŸ¯ Goal achievement
end loop

RG -> RG: **29. detect_anomalies()**\nâš ï¸ Exception reporting

RG -> RG: **30. generate_executive_summary()**\nğŸ“‹ Key insights

' ============================================
' PHASE 5: VISUALIZATION PREPARATION
' ============================================

RG -> VS: **31. prepare_visualizations()**\nğŸ“Š Chart generation
activate VS

VS -> VS: **32. create_revenue_chart()**\nğŸ“ˆ Line/bar charts
VS -> VS: **33. create_method_pie_chart()**\nğŸ¥§ Payment distribution
VS -> VS: **34. create_trend_heatmap()**\nğŸ”¥ Revenue patterns
VS -> VS: **35. create_comparison_charts()**\nâš–ï¸ Period comparison

VS -> VS: **36. optimize_chart_data()**\nâš¡ Performance tuning
VS -> VS: **37. apply_branding_styles()**\nğŸ¨ Corporate design

VS --> RG: **38. RETURN visualization_data**\nâœ… Charts ready
deactivate VS

' ============================================
' PHASE 6: REPORT ASSEMBLY
' ============================================

RG --> RP: **39. RETURN complete_report**\nğŸ“‹ Data + Visualizations
deactivate RG

RP -> RP: **40. render_dashboard()**\nğŸ–¥ï¸ Interactive display
note right of RP
  <color:#2C3E50><b>Dashboard Features</b></color>
  â€¢ Interactive filters
  â€¢ Real-time updates
  â€¢ Drill-down capability
  â€¢ Export options
  â€¢ Sharing features
end note

RP -> RP: **41. display_metrics_summary()**\nğŸ“Š Key statistics

RP -> RP: **42. render_charts_visualization()**\nğŸ“ˆ Graphical display

RP -> RP: **43. enable_interactivity()**\nğŸ–±ï¸ User controls

RP --> Admin: **44. DISPLAY revenue_dashboard**\nğŸ‰ Report complete
note right of RP
  <color:#2C3E50><b>Report Contents</b></color>
  â€¢ Executive summary
  â€¢ Revenue breakdown
  â€¢ Payment method analysis
  â€¢ Comparative metrics
  â€¢ Trend projections
  â€¢ Actionable insights
end note

deactivate RP

' ============================================
' PHASE 7: EXPORT & DISTRIBUTION
' ============================================

alt **Export to PDF**
  Admin -> RP: **45. SELECT "Export PDF"**\nğŸ“„ Document export
  activate RP
  
  RP -> ES: **46. export_report_to_pdf()**\nğŸ–¨ï¸ PDF generation
  activate ES
  
  ES -> ES: **47. generate_pdf_document()**\nğŸ“‹ Layout creation
  note right of ES
    <color:#2C3E50><b>PDF Features</b></color>
    â€¢ Professional formatting
    â€¢ Corporate branding
    â€¢ Watermark (Confidential)
    â€¢ Digital timestamps
    â€¢ Print optimization
  end note
  
  ES -> ES: **48. apply_security_features()**\nğŸ”’ Document protection
  ES -> ES: **49. optimize_file_size()**\nâš¡ Performance
  
  ES --> RP: **50. RETURN pdf_document**\nâœ… PDF ready
  deactivate ES
  
  RP -> RP: **51. initiate_file_download()**\nâ¬‡ï¸ Browser download
  RP --> Admin: **52. DOWNLOAD complete_pdf**\nğŸ“„ Document saved
  deactivate RP
  
else **Export to Spreadsheet**
  Admin -> RP: **53. SELECT "Export Excel"**\nğŸ“Š Data export
  RP -> ES: **54. export_to_spreadsheet()**\nğŸ“ˆ Excel generation
  ES --> RP: **55. RETURN spreadsheet_file**\nâœ… Excel ready
  RP --> Admin: **56. DOWNLOAD data_file**\nğŸ“Š Raw data
end

' ============================================
' PHASE 8: AUDIT & COMPLETION
' ============================================

RP -> DB: **57. LOG report_generation**\nğŸ“‹ Audit trail
activate DB
DB --> RP: **58. RETURN audit_confirmed**\nâœ… Record saved
deactivate DB

RP -> RP: **59. update_usage_statistics()**\nğŸ“ˆ Analytics usage

RP -> Admin: **60. NOTIFY completion**\nâœ… Process finished

' ============================================
' SUMMARY & LEGEND
' ============================================

note over Admin, DB
  <color:#2C3E50><b>Revenue Report Summary</b></size></color>
  
  <b>â±ï¸ Processing Time:</b> 2-10 seconds
  <b>ğŸ“Š Data Points Processed:</b> Thousands to millions
  <b>ğŸ”— System Components:</b> 6+ services
  <b>ğŸ“ˆ Report Types:</b> 10+ metrics categories
  
  <b>Key Financial Metrics:</b>
  â€¢ Total Revenue: [Calculated]
  â€¢ Average Daily Rate (ADR)
  â€¢ Revenue Per Available Room (RevPAR)
  â€¢ Gross Operating Profit (GOP)
  â€¢ Net Revenue Management
  
  <b>Compliance & Security:</b>
  â€¢ Financial data encryption
  â€¢ Access control & permissions
  â€¢ Audit trail maintenance
  â€¢ Data retention policies
  â€¢ GDPR compliance
end note

legend right
  | <b>Component Type</b> | <b>Color</b> |
  | Management User | <color:#1976D2>â–ˆ</color> |
  | User Interface | <color:#2C3E50>â–ˆ</color> |
  | Service Layer | <color:#D32F2F>â–ˆ</color> |
  | External Service | <color:#FF9800>â–ˆ</color> |
  | Database | <color:#7B1FA2>â–ˆ</color> |
  | **Process Step** | **Icon** |
  | Data Extraction | ğŸ“Š |
  | Calculation | ğŸ§® |
  | Visualization | ğŸ“ˆ |
  | Export | ğŸ“„ |
  | Completion | âœ… |
end legend

@enduml